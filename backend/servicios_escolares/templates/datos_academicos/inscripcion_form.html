{% load static %}

<form id="inscripcionForm" onsubmit="return procesarInscripcion(this);" enctype="multipart/form-data">
    {% csrf_token %}
    
    <!-- Información Personal -->
    <div class="card mb-4">
        <div class="card-header bg-primary text-white">
            <h6 class="mb-0"><i class="fas fa-user me-2"></i>Información Personal</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="{{ form.nombre.id_for_label }}" class="form-label">Nombre(s) *</label>
                    {{ form.nombre }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.apellido_paterno.id_for_label }}" class="form-label">Apellido Paterno *</label>
                    {{ form.apellido_paterno }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.apellido_materno.id_for_label }}" class="form-label">Apellido Materno</label>
                    {{ form.apellido_materno }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="{{ form.curp.id_for_label }}" class="form-label">CURP *</label>
                    {{ form.curp }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.fecha_nacimiento.id_for_label }}" class="form-label">Fecha de Nacimiento *</label>
                    {{ form.fecha_nacimiento }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.genero.id_for_label }}" class="form-label">Género *</label>
                    {{ form.genero }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ form.email.id_for_label }}" class="form-label">Correo Electrónico *</label>
                    {{ form.email }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ form.telefono.id_for_label }}" class="form-label">Teléfono *</label>
                    {{ form.telefono }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información Académica -->
    <div class="card mb-4">
        <div class="card-header bg-success text-white">
            <h6 class="mb-0"><i class="fas fa-graduation-cap me-2"></i>Información Académica</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ form.carrera.id_for_label }}" class="form-label">Carrera *</label>
                    {{ form.carrera }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ form.modalidad.id_for_label }}" class="form-label">Modalidad *</label>
                    {{ form.modalidad }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="{{ form.escuela_procedencia.id_for_label }}" class="form-label">Escuela de Procedencia *</label>
                    {{ form.escuela_procedencia }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.promedio_bachillerato.id_for_label }}" class="form-label">Promedio de Bachillerato *</label>
                    {{ form.promedio_bachillerato }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.año_egreso.id_for_label }}" class="form-label">Año de Egreso *</label>
                    {{ form.año_egreso }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información de Contacto -->
    <div class="card mb-4">
        <div class="card-header bg-info text-white">
            <h6 class="mb-0"><i class="fas fa-map-marker-alt me-2"></i>Información de Contacto</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-12 mb-3">
                    <label for="{{ form.direccion.id_for_label }}" class="form-label">Dirección *</label>
                    {{ form.direccion }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="{{ form.municipio.id_for_label }}" class="form-label">Municipio *</label>
                    {{ form.municipio }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.estado.id_for_label }}" class="form-label">Estado *</label>
                    {{ form.estado }}
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-4 mb-3">
                    <label for="{{ form.codigo_postal.id_for_label }}" class="form-label">Código Postal *</label>
                    {{ form.codigo_postal }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Documentos -->
    <div class="card mb-4">
        <div class="card-header bg-warning text-dark">
            <h6 class="mb-0"><i class="fas fa-file-alt me-2"></i>Documentos Requeridos</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ form.acta_nacimiento.id_for_label }}" class="form-label">Acta de Nacimiento</label>
                    {{ form.acta_nacimiento }}
                    <div class="form-text">Formato PDF, máximo 5MB</div>
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ form.certificado_bachillerato.id_for_label }}" class="form-label">Certificado de Bachillerato</label>
                    {{ form.certificado_bachillerato }}
                    <div class="form-text">Formato PDF, máximo 5MB</div>
                    <div class="invalid-feedback"></div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="{{ form.curp_documento.id_for_label }}" class="form-label">CURP (Documento)</label>
                    {{ form.curp_documento }}
                    <div class="form-text">Formato PDF, máximo 5MB</div>
                    <div class="invalid-feedback"></div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="{{ form.fotografias.id_for_label }}" class="form-label">Fotografías</label>
                    {{ form.fotografias }}
                    <div class="form-text">Formato JPG/PNG, máximo 5MB</div>
                    <div class="invalid-feedback"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Información Adicional -->
    <div class="card mb-4">
        <div class="card-header bg-secondary text-white">
            <h6 class="mb-0"><i class="fas fa-info-circle me-2"></i>Información Adicional</h6>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-12 mb-3">
                    <label for="{{ form.observaciones.id_for_label }}" class="form-label">Observaciones</label>
                    {{ form.observaciones }}
                    <div class="invalid-feedback"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Botones de Acción -->
    <div class="d-flex justify-content-end gap-2">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="fas fa-times me-2"></i>Cancelar
        </button>
        <button type="submit" class="btn btn-success">
            <i class="fas fa-save me-2"></i>Registrar Inscripción
        </button>
    </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Agregar clases de Bootstrap a los campos del formulario
    const formFields = document.querySelectorAll('#inscripcionForm input, #inscripcionForm select, #inscripcionForm textarea');
    formFields.forEach(field => {
        field.classList.add('form-control');
        if (field.type === 'file') {
            field.classList.remove('form-control');
            field.classList.add('form-control-file');
        }
    });

    // Validación en tiempo real para CURP
    const curpField = document.getElementById('{{ form.curp.id_for_label }}');
    if (curpField) {
        curpField.addEventListener('input', function() {
            const curp = this.value.toUpperCase();
            const curpRegex = /^[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9A-Z][0-9]$/;
            
            if (curp.length === 18 && !curpRegex.test(curp)) {
                this.classList.add('is-invalid');
                this.nextElementSibling.textContent = 'CURP no válida';
            } else {
                this.classList.remove('is-invalid');
                this.nextElementSibling.textContent = '';
            }
        });
    }

    // Validación para código postal
    const cpField = document.getElementById('{{ form.codigo_postal.id_for_label }}');
    if (cpField) {
        cpField.addEventListener('input', function() {
            const cp = this.value;
            if (cp.length === 5 && !/^\d{5}$/.test(cp)) {
                this.classList.add('is-invalid');
                this.nextElementSibling.textContent = 'Código postal debe tener 5 dígitos';
            } else {
                this.classList.remove('is-invalid');
                this.nextElementSibling.textContent = '';
            }
        });
    }

    // Validación para email
    const emailField = document.getElementById('{{ form.email.id_for_label }}');
    if (emailField) {
        emailField.addEventListener('input', function() {
            const email = this.value;
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            
            if (email && !emailRegex.test(email)) {
                this.classList.add('is-invalid');
                this.nextElementSibling.textContent = 'Email no válido';
            } else {
                this.classList.remove('is-invalid');
                this.nextElementSibling.textContent = '';
            }
        });
    }
});
</script>